# Terminal Command Allowlist
# Commands set to `true` are auto-approved, `false` are auto-denied.
# Regex patterns (wrapped in /.../) can match command lines.
# User config location: ~/.config/daemon/plugins/shell/storage/terminal-cmd-allowlist.yaml

# Basic file/directory commands
cd: true
echo: true
ls: true
pwd: true
cat: true
head: true
tail: true
findstr: true
wc: true
tr: true
cut: true
cmp: true
which: true
basename: true
dirname: true
realpath: true
readlink: true
stat: true
file: true
du: true
df: true
sleep: true

# Git read-only commands
git status: true
git log: true
git show: true
git diff: true

# PowerShell safe commands
Get-ChildItem: true
Get-Content: true
Get-Date: true
Get-Random: true
Get-Location: true
Write-Host: true
Write-Output: true
Split-Path: true
Join-Path: true
Start-Sleep: true
Where-Object: true
/^Select-[a-z0-9]/i: true
/^Measure-[a-z0-9]/i: true
/^Compare-[a-z0-9]/i: true
/^Format-[a-z0-9]/i: true
/^Sort-[a-z0-9]/i: true

# Commands with dangerous flag restrictions
column: true
/^column\b.*-c\s+[0-9]{4,}/: false
date: true
/^date\b.*(-s|--set)\b/: false
find: true
/^find\b.*-(delete|exec|execdir|fprint|fprintf|fls|ok|okdir)\b/: false
grep: true
/^grep\b.*-(f|P)\b/: false
sort: true
/^sort\b.*-(o|S)\b/: false
tree: true
/^tree\b.*-o\b/: false

# Dangerous commands - denied by default
rm: false
rmdir: false
del: false
Remove-Item: false
ri: false
rd: false
erase: false
dd: false
kill: false
ps: false
top: false
Stop-Process: false
spps: false
taskkill: false
taskkill.exe: false
curl: false
wget: false
Invoke-RestMethod: false
Invoke-WebRequest: false
irm: false
iwr: false
chmod: false
chown: false
Set-ItemProperty: false
sp: false
Set-Acl: false
jq: false
xargs: false
eval: false
Invoke-Expression: false
iex: false